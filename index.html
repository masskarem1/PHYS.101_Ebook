<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PHYS101 Flipbook</title>
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">

  <!-- External Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>

  <!-- MathJax for Equations -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script async id="MathJax-script"
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ========== Optional Login ========== -->
<div id="lockScreen">
  <div class="lock-box">
    <h2>Enter your Student ID</h2>
    <input id="idInput" type="text" maxlength="12" placeholder="Student ID" />
    <button id="unlockBtn">Unlock</button>
    <p id="idError" style="color:red;display:none;">Invalid ID</p>
  </div>
</div>

<!-- ========== Toolbar ========== -->
<div class="toolbar-container">
  <div class="toolbar">
    <button onclick="firstPage()">⏮ First</button>
    <button onclick="prevPage()">⬅ Prev</button>
    <input id="pageInput" type="number" min="1" placeholder="Page #" />
    <button onclick="jumpToPage()">Go</button>
    <button onclick="nextPage()">Next ➡</button>
    <button onclick="lastPage()">⏭ Last</button>

    <div class="highlight-buttons-group">
      <button id="toggle-draw-mode-btn" title="Toggle Draw Mode (D)">✏️ Draw</button>
      <button id="highlight-settings-btn" title="Drawing Settings">⌄</button>
    </div>

    <button id="searchBtn" title="Search Book (S)">🔍 Search</button>
    <button id="phetBtn" style="display:none;">🔬 Simulation</button>
    <button id="videoBtn" style="display:none;">▶️ Video</button>
  </div>

  <!-- Highlight Popup -->
  <div id="highlight-popup" class="highlight-popup">
    <div class="popup-section">
      <label>Tool:</label>
      <button id="pen-tool-btn-popup" class="tool-btn">Pen</button>
      <button id="highlight-tool-btn" class="tool-btn active">Marker</button>
      <button id="eraser-tool-btn-popup" class="tool-btn">Eraser</button>
    </div>
    <div class="popup-section">
      <label>Color:</label>
      <div class="color-swatches">
        <div class="color-swatch active" data-color="rgba(255,255,0,0.4)"
             style="background-color:rgba(255,255,0,0.5);"></div>
        <div class="color-swatch" data-color="rgba(144,238,144,0.4)"
             style="background-color:rgba(144,238,144,0.5);"></div>
        <div class="color-swatch" data-color="rgba(0,191,255,0.4)"
             style="background-color:rgba(0,191,255,0.5);"></div>
        <div class="color-swatch" data-color="rgba(255,192,203,0.4)"
             style="background-color:rgba(255,192,203,0.5);"></div>
        <div class="color-swatch" data-color="rgba(255,99,71,0.4)"
             style="background-color:rgba(255,99,71,0.5);"></div>
      </div>
    </div>
    <div class="popup-section">
      <label for="brush-size-popup">Size:</label>
      <input type="range" id="brush-size-popup" min="30" max="90" value="40">
    </div>
    <div class="popup-section">
      <button id="clear-highlights-btn-popup">Clear Page</button>
    </div>
  </div>

  <!-- Search Bar -->
  <div id="searchContainer" style="display:none;">
    <input type="text" id="searchInput" placeholder="Search book text...">
    <button id="searchCloseBtn">×</button>
    <div id="searchResults"></div>
  </div>
</div>

<!-- ========== Thumbnails ========== -->
<div id="thumbbar" class="thumbbar"></div>

<!-- ========== Flipbook Pages ========== -->
<div id="flipbook"></div>

<!-- ========== Footer ========== -->
<div id="footer">
  <div class="footer-left"><button id="indexToggle">☰ Index</button></div>
  <div id="pageCounter">Page 1 / ---</div>
  <div class="footer-right">
    <button id="fullBtn" onclick="toggleFullScreen()">⛶</button>
    <button id="shareBtn" onclick="shareBook()">🔗</button>
  </div>
  <div id="indexMenu"></div>
</div>

<!-- ========== AI Helper ========== -->
<button id="aiHelperToggle" title="AI Study Helper (A)">🧠</button>
<div id="aiHelperModal">
  <div class="ai-content">
    <button id="aiCloseBtn">×</button>
    <h2>AI Study Helper</h2>
    <p>Get help with <strong id="aiChapterTitle">Chapter X</strong>.</p>
    <div class="ai-buttons">
      <button onclick="getAiHelp('explain')">Explain Concept</button>
      <button onclick="getAiHelp('quiz')">Quiz Me</button>
      <button onclick="getAiHelp('relate')">Relate to Life Sciences</button>
      <button onclick="getAiHelp('analyze_page')">Analyze Page</button>
      <button onclick="translateCurrentPage()">🌐 Translate</button>
    </div>
    <div id="aiResponse" class="ai-response"></div>
    <div id="aiLoading" style="display:none;">Thinking...</div>
    <button id="translate-analysis-btn" style="display:none;">🌐 Translate Output</button>
  </div>
</div>

<!-- ========== PhET Modal ========== -->
<div id="phetModal">
  <div class="phet-content">
    <button id="phetCloseBtn">×</button>
    <iframe id="phetFrame" src="about:blank" allowfullscreen></iframe>
  </div>
</div>

<!-- ========== Video Modal ========== -->
<div id="videoModal">
  <div class="video-content">
    <button id="videoCloseBtn">×</button>
    <iframe id="videoFrame" src="about:blank" allowfullscreen></iframe>
  </div>
</div>

<!-- Scripts -->
<script src="config.js"></script>
<script src="app.js" defer></script>

</body>
</html>
